letters = "m&($i}9nl1)a0vo6_p27dxb{^8wgzyef#cj5kq+tsu@3*h4%r!"
trees = [
"(()((()(()()))(((((()())())())((()((()(()()))()))()))(((()(((()())())(()())))((()((()(()()))()))(((()())())(()()))))(((()())())(()()))))))(((((()())())())())((()(()()))(((()())(()()))(()(()(()()))))))",
"(()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))((((()())(((()())())(()())))(((()())())(()())))(((((()())())())())((()(()()))(((()())(()()))(()(()(()())))))))",
"((()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))((((()())(((()())())(()())))(((()())())(()())))((()())())))((()())((()(()()))(((()())(()()))(()(()(()()))))))",
"((()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))(((()())(((()())())(()())))(((()())())())))((()((()())()))((()())((()(()()))(((()())(()()))(()(()(()())))))))",
"((()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))((()())(()())))(((()(()()))(((()())())()))((()((()())()))((()())((()(()()))(((()())(()()))(()(()(()()))))))))",
"(((()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))((()())(()())))(((()(()()))(((()())())()))((()((()())()))((()())((()(()()))(((()())(()()))(()())))))))(()())",
"(((()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))((()())(()())))(((()(()()))(((()())())()))((()((()())()))(()()))))(((()(()()))(((()())(()()))(()())))(()()))",
"(()((()(()()))((((()())())())(()()))))(((((((()())())())((()(((()())())(()())))(()(()()))))((()())(()())))(((()(()()))(((()())())()))((()((()())()))(()()))))(((()(()()))(((()())(()()))(()())))(()())))",
"((()((()(()()))((((()())())())(()()))))(((((((()())())())((()(((()())())(()())))(()(()()))))((()())(()())))(((()(()()))(((()())())()))((()((()())()))(()()))))(()())))((()(((()())(()()))(()())))(()()))",
"((()((()(()()))((((()())())())(()()))))(((()())())()))((((((()(((()())())(()())))(()(()())))((()())(()())))(((()(()()))(((()())())()))((()((()())()))(()()))))(()()))((()(((()())(()()))(()())))(()())))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))(((((()(((()())())(()())))(()(()())))((()())(()())))(((()(()()))(((()())())()))((()((()())()))(()()))))(()())))((()(((()())(()()))(()())))(()()))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))((((()(((()())())(()())))(()(()())))((()())(()())))((()(()()))())))(((((()())())((()((()())()))(()())))(()()))((()(((()())(()()))(()())))(()())))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))((((()(((()())())(()())))(()(()())))((()())(()())))((()(()()))())))(((()())())(()())))((((()())(()()))(()()))((()(((()())(()()))(()())))(()())))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))((((()(((()())())(()())))(()(()())))((()())(()())))(()())))(((()())(((()())())(()())))((((()())(()()))(()()))((()(((()())(()()))(()())))(()()))))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))((()(((()())())(()())))(()())))(((()((()())(()())))(()()))(((()())(((()())())(()())))((((()())(()()))(()()))((()(((()())(()()))(()())))(()())))))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))((()(((()())())(()())))(()())))(((()((()())(()())))(()()))(((()())(((()())())(()())))((((()())(()()))(()()))()))))((((()())(()()))(()()))(()()))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))((()(((()())())(()())))(()())))(((()((()())(()())))(()()))((()())(((()())())(()())))))(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))((()(((()())())(()())))(()())))(()()))((((()(()()))(()()))((()())(((()())())(()()))))(((((()())(()()))(()()))())((((()())(()()))(()()))(()()))))",
"((()((()(()()))((((()())())())(()()))))(((()())())()))((((()(((()())())(()())))(()()))(()()))((((()(()()))(()()))((()())(((()())())(()()))))(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))((((()(((()())())(()())))(()()))(()()))(((()(()()))(()()))((()())((()())())))))((()())(((((()())(()()))(()()))())((((()())(()()))(()()))(()()))))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))(((()(((()())())(()())))(()()))()))((()(((()(()()))(()()))((()())((()())()))))((()())(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))(((()(((()())())(()())))(()()))()))((()(((()(()()))(()()))((()())((()())()))))(()())))(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))(((()(((()())())(()())))(()()))()))(()()))(((((()())(()()))((()())((()())())))(()()))(((((()())(()()))(()()))())((((()())(()()))(()()))(()()))))",
"((()((()(()()))((((()())())())(()()))))((()())()))(((()(((()(((()())())(()())))(()()))()))(()()))(((((()())(()()))((()())((()())())))(()()))(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(((()(((()(((()())())(()())))(()()))()))(()()))()))((((()(()()))((()())((()())())))(()()))(((((()())(()()))(()()))())((((()())(()()))(()()))(()()))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())((((()(()()))((()())((()())())))(()()))(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())((((()(()()))((()())((()())())))(()()))(((()())(()()))(()())))))(()((((()())(()()))(()()))(()())))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())((((()(()()))((()())((()())())))(()()))((()())(()())))))((()())(()((((()())(()()))(()()))(()()))))",
"((()((()(()()))((((()())())())(()()))))((()())()))(((()((()(((()())())(()())))(()())))(((()(()()))())((((()(()()))((()())((()())())))(()()))((()())(()())))))((()())(()((((()())(()()))(()()))(()())))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))((()((()(((()())())(()())))(()())))(((()(()()))())())))(((((()())((()())((()())())))(()()))((()())(()())))((()())(()((((()())(()()))(()()))(()())))))",
"((((()((()(()()))((((()())())())(()()))))((()())()))((()((()(((()())())(()())))(()())))(((()(()()))())())))(((((()())((()())((()())())))(()()))((()())(()())))()))(()(()((((()())(()()))(()()))(()()))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((((()(()()))())())(((((()())((()())((()())())))(()()))((()())(()())))()))(()(()((((()())(()()))(()()))(()())))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))())(((()(((()())())(()())))(()()))(((((()(()()))())())(((((()())((()())((()())())))(()()))((()())(()())))()))(()(()((((()())(()()))(()()))(()()))))))",
"((((()((()(()()))((((()())())())(()()))))((()())()))())(((()(((()())())(()())))(()()))((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))))(()(()(()((((()())(()()))(()()))(()())))))",
"((()((()(()()))((((()())())())(()()))))((()())()))((()(((()(((()())())(()())))(()()))((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))))(()(()(()((((()())(()()))(()()))(()()))))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))(()(()(()((((()())(()()))(()()))(()()))))))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))(()(()(()())))))(((()(()()))(()()))(()()))",
"((()((()(()()))((((()())())())(()()))))((()())()))(((()((()(((()())())(()())))(()())))(((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))(()(()(()())))))(((()(()()))(()()))(()())))",
"(((()((()(()()))((((()())())())(()()))))((()())()))((()((()(((()())())(()())))(()())))((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))))((()(()(()())))(((()(()()))(()()))(()())))",
"((((()((()(()()))((((()())())())(()()))))((()())()))((()((()(((()())())(()())))(()())))((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))))((()(()(()())))(()(()()))))((()())(()()))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))((()(()(()())))(()(()()))))((()())(()())))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))(()(()(()())))))((()(()()))((()())(()())))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())()))((((((()())((()())((()())())))(()()))((()())(()())))(()(()(()()))))((()(()()))((()())(()()))))",
"(((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())()))((((()())((()())((()())())))(()()))((()())(()()))))((()(()(()())))((()(()()))((()())(()()))))",
"((((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())()))((((()())((()())((()())())))(()()))((()())(()()))))((()(()(()())))(()(()()))))((()())(()()))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))((()(()(()())))(()(()()))))((()())(()())))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((()(()()))())())()))(((((()((()())((()())())))(()()))((()())(()())))((()(()(()())))(()(()()))))((()())(()())))",
"(((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((()(()()))())())()))((((()((()())((()())())))(()()))((()())(()())))(()(()()))))((()(()(()())))((()())(()())))",
"(((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((()(()()))())())()))((()((()())((()())())))(()())))((((()())(()()))(()(()())))((()(()(()())))((()())(()()))))",
"((((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((()(()()))())())()))((()((()())((()())())))(()())))((((()())(()()))(()(()())))((()(()(()())))((()())()))))()",
]

import subprocess
basecommand = "../source/spinning_around"

flag_len = len(trees) 

def perm_to_val(perm):
  rank = []
  val = ["0"]*len(perm)
  for i, j in enumerate(perm):
    rank = rank[:j] + [i] + rank[j:]
  for i, r in enumerate(rank):
    val[r] = letters[i]
  return val 


perm = []

extra = ["x"]*flag_len
for i in range(flag_len):
  for j in letters:
    extra[i] = j
    print("[+] TESTING STRING: ","".join(extra))
    p = subprocess.run([basecommand,"".join(extra)], capture_output=True, text = True)
    print("" + p.stdout)
    if p.stdout.split()[0] == "You":
      break
    ret_tree = p.stdout.split('\n')[0].split()[-1]
    ret_id = trees[i:].index(ret_tree) + i
    if ret_id == i+1: break
print("[+] Found flag:", "".join(extra))
