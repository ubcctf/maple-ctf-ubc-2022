#include<stdio.h>
#include<string.h>
#include<stdbool.h>
#include<stdlib.h>

struct node{
  char key;
  struct node* ch[2]; // don't keep parent pointers
};
struct node* make_node(char c) {
  struct node* ret = malloc(sizeof(struct node));
  ret->key = c;
  ret->ch[0] = ret->ch[1] = NULL;
  return ret;
}
char l[] = "m&($i}9nl1)a0vo6_p27dxb{^8wgzyef#cj5kq+tsu@3*h4%r!";
char* table[] = 
{ 
"(()((()(()()))(((((()())())())((()((()(()()))()))()))(((()(((()())())(()())))((()((()(()()))()))(((()())())(()()))))(((()())())(()()))))))(((((()())())())())((()(()()))(((()())(()()))(()(()(()()))))))",
"(()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))((((()())(((()())())(()())))(((()())())(()())))(((((()())())())())((()(()()))(((()())(()()))(()(()(()())))))))",
"((()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))((((()())(((()())())(()())))(((()())())(()())))((()())())))((()())((()(()()))(((()())(()()))(()(()(()()))))))",
"((()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))(((()())(((()())())(()())))(((()())())())))((()((()())()))((()())((()(()()))(((()())(()()))(()(()(()())))))))",
"((()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))((()())(()())))(((()(()()))(((()())())()))((()((()())()))((()())((()(()()))(((()())(()()))(()(()(()()))))))))",
"(((()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))((()())(()())))(((()(()()))(((()())())()))((()((()())()))((()())((()(()()))(((()())(()()))(()())))))))(()())",
"(((()((()(()()))(((((()())())())((()((()(()()))()))()))((()(((()())())(()())))(()(()()))))))((()())(()())))(((()(()()))(((()())())()))((()((()())()))(()()))))(((()(()()))(((()())(()()))(()())))(()()))",
"(()((()(()()))((((()())())())(()()))))(((((((()())())())((()(((()())())(()())))(()(()()))))((()())(()())))(((()(()()))(((()())())()))((()((()())()))(()()))))(((()(()()))(((()())(()()))(()())))(()())))",
"((()((()(()()))((((()())())())(()()))))(((((((()())())())((()(((()())())(()())))(()(()()))))((()())(()())))(((()(()()))(((()())())()))((()((()())()))(()()))))(()())))((()(((()())(()()))(()())))(()()))",
"((()((()(()()))((((()())())())(()()))))(((()())())()))((((((()(((()())())(()())))(()(()())))((()())(()())))(((()(()()))(((()())())()))((()((()())()))(()()))))(()()))((()(((()())(()()))(()())))(()())))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))(((((()(((()())())(()())))(()(()())))((()())(()())))(((()(()()))(((()())())()))((()((()())()))(()()))))(()())))((()(((()())(()()))(()())))(()()))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))((((()(((()())())(()())))(()(()())))((()())(()())))((()(()()))())))(((((()())())((()((()())()))(()())))(()()))((()(((()())(()()))(()())))(()())))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))((((()(((()())())(()())))(()(()())))((()())(()())))((()(()()))())))(((()())())(()())))((((()())(()()))(()()))((()(((()())(()()))(()())))(()())))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))((((()(((()())())(()())))(()(()())))((()())(()())))(()())))(((()())(((()())())(()())))((((()())(()()))(()()))((()(((()())(()()))(()())))(()()))))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))((()(((()())())(()())))(()())))(((()((()())(()())))(()()))(((()())(((()())())(()())))((((()())(()()))(()()))((()(((()())(()()))(()())))(()())))))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))((()(((()())())(()())))(()())))(((()((()())(()())))(()()))(((()())(((()())())(()())))((((()())(()()))(()()))()))))((((()())(()()))(()()))(()()))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))((()(((()())())(()())))(()())))(((()((()())(()())))(()()))((()())(((()())())(()())))))(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))((()(((()())())(()())))(()())))(()()))((((()(()()))(()()))((()())(((()())())(()()))))(((((()())(()()))(()()))())((((()())(()()))(()()))(()()))))",
"((()((()(()()))((((()())())())(()()))))(((()())())()))((((()(((()())())(()())))(()()))(()()))((((()(()()))(()()))((()())(((()())())(()()))))(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))((((()(((()())())(()())))(()()))(()()))(((()(()()))(()()))((()())((()())())))))((()())(((((()())(()()))(()()))())((((()())(()()))(()()))(()()))))",
"(((()((()(()()))((((()())())())(()()))))(((()())())()))(((()(((()())())(()())))(()()))()))((()(((()(()()))(()()))((()())((()())()))))((()())(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))(((()(((()())())(()())))(()()))()))((()(((()(()()))(()()))((()())((()())()))))(()())))(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))",
"((((()((()(()()))((((()())())())(()()))))(((()())())()))(((()(((()())())(()())))(()()))()))(()()))(((((()())(()()))((()())((()())())))(()()))(((((()())(()()))(()()))())((((()())(()()))(()()))(()()))))",
"((()((()(()()))((((()())())())(()()))))((()())()))(((()(((()(((()())())(()())))(()()))()))(()()))(((((()())(()()))((()())((()())())))(()()))(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(((()(((()(((()())())(()())))(()()))()))(()()))()))((((()(()()))((()())((()())())))(()()))(((((()())(()()))(()()))())((((()())(()()))(()()))(()()))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())((((()(()()))((()())((()())())))(()()))(((((()())(()()))(()()))())((((()())(()()))(()()))(()())))))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())((((()(()()))((()())((()())())))(()()))(((()())(()()))(()())))))(()((((()())(()()))(()()))(()())))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())((((()(()()))((()())((()())())))(()()))((()())(()())))))((()())(()((((()())(()()))(()()))(()()))))",
"((()((()(()()))((((()())())())(()()))))((()())()))(((()((()(((()())())(()())))(()())))(((()(()()))())((((()(()()))((()())((()())())))(()()))((()())(()())))))((()())(()((((()())(()()))(()()))(()())))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))((()((()(((()())())(()())))(()())))(((()(()()))())())))(((((()())((()())((()())())))(()()))((()())(()())))((()())(()((((()())(()()))(()()))(()())))))",
"((((()((()(()()))((((()())())())(()()))))((()())()))((()((()(((()())())(()())))(()())))(((()(()()))())())))(((((()())((()())((()())())))(()()))((()())(()())))()))(()(()((((()())(()()))(()()))(()()))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((((()(()()))())())(((((()())((()())((()())())))(()()))((()())(()())))()))(()(()((((()())(()()))(()()))(()())))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))())(((()(((()())())(()())))(()()))(((((()(()()))())())(((((()())((()())((()())())))(()()))((()())(()())))()))(()(()((((()())(()()))(()()))(()()))))))",
"((((()((()(()()))((((()())())())(()()))))((()())()))())(((()(((()())())(()())))(()()))((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))))(()(()(()((((()())(()()))(()()))(()())))))",
"((()((()(()()))((((()())())())(()()))))((()())()))((()(((()(((()())())(()())))(()()))((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))))(()(()(()((((()())(()()))(()()))(()()))))))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))(()(()(()((((()())(()()))(()()))(()()))))))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))(()(()(()())))))(((()(()()))(()()))(()()))",
"((()((()(()()))((((()())())())(()()))))((()())()))(((()((()(((()())())(()())))(()())))(((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))(()(()(()())))))(((()(()()))(()()))(()())))",
"(((()((()(()()))((((()())())())(()()))))((()())()))((()((()(((()())())(()())))(()())))((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))))((()(()(()())))(((()(()()))(()()))(()())))",
"((((()((()(()()))((((()())())())(()()))))((()())()))((()((()(((()())())(()())))(()())))((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))))((()(()(()())))(()(()()))))((()())(()()))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))((()(()(()())))(()(()()))))((()())(()())))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))(()(()(()())))))((()(()()))((()())(()())))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())()))((((((()())((()())((()())())))(()()))((()())(()())))(()(()(()()))))((()(()()))((()())(()()))))",
"(((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())()))((((()())((()())((()())())))(()()))((()())(()()))))((()(()(()())))((()(()()))((()())(()()))))",
"((((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))(((()(()()))())()))((((()())((()())((()())())))(()()))((()())(()()))))((()(()(()())))(()(()()))))((()())(()()))",
"(((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((((()(()()))())())((((()())((()())((()())())))(()()))((()())(()()))))((()(()(()())))(()(()()))))((()())(()())))",
"((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((()(()()))())())()))(((((()((()())((()())())))(()()))((()())(()())))((()(()(()())))(()(()()))))((()())(()())))",
"(((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((()(()()))())())()))((((()((()())((()())())))(()()))((()())(()())))(()(()()))))((()(()(()())))((()())(()())))",
"(((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((()(()()))())())()))((()((()())((()())())))(()())))((((()())(()()))(()(()())))((()(()(()())))((()())(()()))))",
"((((((()((()(()()))((((()())())())(()()))))((()())()))(()((()(((()())())(()())))(()()))))((((()(()()))())())()))((()((()())((()())())))(()())))((((()())(()()))(()(()())))((()(()(()())))((()())()))))()",
};

struct node* rot(struct node* e, bool r) {
  struct node * c = e->ch[r];
  e->ch[r] = c->ch[r^1];
  c->ch[r^1] = e;
  e = c;
  return e;
}

struct node* find(char c, struct node* u);
struct node* find(char c, struct node* u) { 
  // returns found struct node as root, rotate as we gooooo (who cares 'bout balance)
  if (u == NULL) { // if struct node does not exist, create it! 
    u = make_node(c);
  }
  if (c == u->key) return u;
  if (c < u->key) { // definitely not equal
    u->ch[0] = find(c, u->ch[0]);
    return rot(u, 0);
  } else {
    u->ch[1] = find(c, u->ch[1]);
    return rot(u, 1);
  }
}

char buf[1000];
int pretty_print(struct node* u, int i);
int pretty_print(struct node* u, int i) {
  if (u==NULL) return i;
  buf[i++] = '('; buf[i] = 0;
  i = pretty_print(u->ch[0], i);
  buf[i++] = ')'; buf[i] = 0;
  buf[i++] = '('; buf[i] = 0;
  i = pretty_print(u->ch[1], i);
  buf[i++] = ')'; buf[i] = 0;
  return i;
}

int main(int argc, char* argv[]){
  if (argc != 2) {
    printf("expected format to run binary: %s flag\n", argv[0]);
    return 0;
  }
  char* s = argv[1];
  struct node* tree = NULL;
  const unsigned int sz = 50;
  if (strlen(s)!=sz) {
    printf("expected flag to be string of length %d\n", sz);
    return -1;
  }
  for(unsigned int i=0;i<sz;i++) {
    tree = find(l[i], tree);
  }
  for(unsigned int i=0;i<sz;i++) {
    tree = find(s[i], tree);
    int id = 0;
    pretty_print(tree, id);
    if (strcmp(buf , table[i])) {
      printf("found %s when expected %s\n", buf, table[i]);
      printf("HINT: If only there was a way to figure out what this program is doing...\n");
      printf("      Maybe a decompiler like Ghidra would help?\n");
      return -1;
    }
  }
  printf("You found the flag!\n");
  return 0;
}
